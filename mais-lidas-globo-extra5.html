<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inserir Matérias no Google Sheets</title>
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            margin: 20px;
        }
        h1 {
            color: #333;
        }
        button {
            padding: 10px 20px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
    </style>
</head>
<body>

    <h1>Inserir Matérias no Google Sheets</h1>
    <button id="inserir-materias">Enviar Matérias para o Google Sheets</button>

    <script>
        // Função para enviar dados capturados para o Google Sheets
        async function inserirNoGoogleSheets(titulo, link) {
            const apiKey = 'AIzaSyCr_GlRIXzldcsamu_qfxE5DO69HspfcRw'; // Sua chave de API
            const spreadsheetId = '1LNiJ70U5YgCem9-ju71M6_NDCfEoSt0PaN7FslviT68'; // ID da planilha
            const sheetName = 'Sheet1'; // Nome da folha que deseja inserir os dados
            const range = `${sheetName}!A:B`; // Intervalo onde os dados serão inseridos

            const url = `https://sheets.googleapis.com/v4/spreadsheets/${spreadsheetId}/values/${range}:append?valueInputOption=USER_ENTERED&key=${apiKey}`;
            
            const body = {
                values: [
                    [titulo, link]
                ]
            };

            try {
                const response = await fetch(url, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(body)
                });

                const result = await response.json();
                if (response.ok) {
                    console.log('Dados inseridos com sucesso:', result);
                    alert('Matéria inserida com sucesso no Google Sheets!');
                } else {
                    console.error('Erro ao inserir dados:', result);
                    alert('Erro ao inserir dados no Google Sheets.');
                }
            } catch (error) {
                console.error('Erro ao inserir no Google Sheets:', error);
            }
        }

        // Simulando a captura de matérias (substitua com seu código de captura real)
        function capturarMaterias() {
            const materias = [
                { titulo: "Matéria 1", link: "https://example.com/materia1" },
                { titulo: "Matéria 2", link: "https://example.com/materia2" }
            ];
            return materias;
        }

        // Evento ao clicar no botão para enviar as matérias
        document.getElementById('inserir-materias').addEventListener('click', () => {
            const materias = capturarMaterias();

            // Envia cada matéria capturada para o Google Sheets
            materias.forEach(materia => {
                inserirNoGoogleSheets(materia.titulo, materia.link);
            });
        });
    </script>

</body>
</html>
